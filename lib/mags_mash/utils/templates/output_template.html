<html>
<head>
<style>
/*CSS styling*/
table {
    font-family: arial, sans-serif;
    border-collapse: collapse;
    width: 100%;
}

.tab {
    overflow: hidden;
    border: 1px solid #ccc;
    background-color: #f1f1f1;
}
.tab button {
    background-color: inherit;
    float: left;
    border: none;
    outline: none;
    cursor: pointer;
    padding: 14px 16px;
    transition: 0.0s;
    font-size: 17px;
}

.tab button:hover{
    background-color: #ddd;
}

.tab button.active{
    background-color: #ccc;
}

.tabcontent {
    display: none;
    padding: 6px 12px;
    border: 1px solid #ccc;
    border-top: none;
}

td, th {
    border: 1px solid #dddddd;
    text-align: left;
    padding: 8px;
}

tr:nth-child(even){
    background-color: #dddddd
}
</style>
</head>
<!-- HTML below -->
<body>
<div class='tab'>
    <button class="tablinks" onclick="openTab(event, 'stats'" id="defaultOpen">List View</button>
    <button class="tablinks" onclick="openTab(event, 'tree'">Ecosystem Tree</button>
    <!--<button class="tablinks" onclick="openTab(event, 'Map View'">map</button>-->
</div>

<!--
Recursive Tree structure below, fill in with tree=
-->
<ul id="tree" class="tabcontent">
    {%- for t in tree recursive %}
        <li><span class="caret">{{t.name}} ({{t.count}})</span>
        {%- if t.children -%}
            <ul class="nested">{{ loop(t.children) }} </ul>
        {%- endif %}</li>
    {%- endfor %}
</ul>
<!--
Statistics List view
-->
<ul id='stats' class="tabcontent">
    <table>
        <tr>
            <th>Distance</th>
            <th>KBase ID</th>
            <th>GOLD Analysis Project ID</th>
            <th>GOLD Sequencing Project ID</th>
            <th>IMG Genome ID</th>
            <th>Completeness</th>
            <th>Contamination</th>
            <th>MIMAG</th>
            <th>Project/Study Name</th>
        </tr>
        {% for item in stats %}
        <tr>
            <th>{{item.dist}}</th>
            <th>{{item.mag_id}}</th>
            <th>{{item.kb_id}}</th>
            <th>{{item.GOLD_Analysis_ID}}</th>
            <th>{{item.GOLD_Sequencing_ID}}</th>
            <th>{{item.IMG_Genome_ID}}</th>
            <th>{{item.completeness}}</th>
            <th>{{item.contamination}}</th>
            <th>{{item.MIMAG}}</th>
            <th>{{item.project}}</th>
        </tr>
        {% endfor %}
    </table>    
</ul>
<!--
Google maps view below
Looks like we'll have to use the google maps api to get this done

NOTE: hold off on this for now.

<div id="map" class="tabcontent"></div>
-->
<script>
    function openTab(evt, name) {
        // Declare all variables
        var i, tabcontent, tablinks;

        // Get all elements with class="tabcontent" and hide them
        tabcontent = document.getElementsByClassName("tabcontent");
        for (i = 0; i < tabcontent.length; i++) {
            tabcontent[i].style.display = "none";
        }

        // Get all elements with class="tablinks" and remove the class "active"
        tablinks = document.getElementsByClassName("tablinks");
        for (i = 0; i < tablinks.length; i++) {
            tablinks[i].className = tablinks[i].className.replace(" active", "");
        }  

        // Show the current tab, and add an "active" class to the button that opened the tab
        document.getElementById(name).style.display = "block";
        evt.currentTarget.className += " active";   
    }
    document.getElementById("defaultOpen").click();
</script>
<!--
<script>
    function initMap(){
        var map;
        var bounds = new google.maps.LatLngBounds()
        var mapOptions = {
            mapTypeId: 'roadmap'
        };
    
        map = new google.maps.Map(document.getElementById('map'), mapOptions);
        
        // set values of markers
        var markers = {{markers|safe}};
        // [name, lat, lng], [name, lat, lng],.....
        
       
        // not sure if we want to include this yet
        // Add in a information window on the marker
        //var infoWindowContent =  {{infoWindowContent|safe}};
        //var infoWindowContent = [
        //    ['put html here'], ['put html here'], .....
        //]
        
        //var infoWindow = new google.maps.InfoWindow(), marker, i;
        

        for( i = 0; i < markers.length; i++ ) {
            var position = new google.maps.LatLng(markers[i][1], markers[i][2]);
            bounds.extend(position);
            marker = new google.maps.Marker({
                position: position,
                map: map,
                title: markers[i][0]
            });
        
            // Allow each marker to have an info window    
            //google.maps.event.addListener(marker, 'click', (function(marker, i) {
            //    return function() {
            //        infoWindow.setContent(infoWindowContent[i][0]);
            //        infoWindow.open(map, marker);
            //    }
            //})(marker, i));

            // Automatically center the map fitting all markers on the screen
            map.fitBounds(bounds);
        }
        var boundsListener = google.maps.event.addListener((map), "bounds_changed", function(event){
            this.setZoom(3);
            google.maps.event.removeListener(boundsListener);
        });
    }
</script>
<script src="https://maps.googleapis.com/maps/api/js?key=[APIKEYHERE]&callback=initMap" async defer></script>
-->
</body>
</html>
